---
title: Cloudflare R2ã‚’è©¦ã—ã¦ã¿ã‚‹
description: CloudflareãŒæä¾›ã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚µãƒ¼ãƒ“ã‚¹ã‚’è©¦ã—ã¦ã¿ã¾ã™ã€‚
og:
  - title: Cloudflare R2ã‚’è©¦ã—ã¦ã¿ã‚‹
    description: true
  - image: https://storage.ephy.dev/blog-resources/article-cloudflare-r2/cover/image.webp
    image:alt: Article cover
publishedAt: "2023-12-08"
tags:
  - Cloudflare
---

import { FigImage } from "~/components/utils/fig-image.tsx";
import { Video } from "~/components/utils/video.tsx";
import { ArticleHead } from "~/components/article/article-head";

<ArticleHead />

## Cloudflare R2ã‚’è©¦ã—ã¦ã¿ã‚‹

å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’èª­ã¿ãªãŒã‚‰é€²ã‚ã¦ã¿ã¾ã™ã€‚

[Cloudflare R2 - Get Started](https://developers.cloudflare.com/r2/get-started/)

Cloudflareã®CLIãƒ„ãƒ¼ãƒ«ã§ã‚ã‚‹`wrangler`ã‚’ä½¿ç”¨ã™ã‚‹ã¿ãŸã„ãªã®ã§ã€npmã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã™ã€‚

```
npm install -g wrangler
```

```
wrangler login
```

åŒæ„ç”»é¢çš„ãªã‚‚ã®ãŒå‡ºã¦ã‹ã‚‰å…ˆã«é€²ã‚€ã¨èªè¨¼ãŒå®Œäº†ã—ã¾ã™ã€‚

<FigImage alt="Wranglerèªè¨¼ç”»é¢" src="https://storage.ephy.dev/blog-resources/article-cloudflare-r2/wrangler-login/" />

## ãƒã‚±ãƒƒãƒˆã‚’ä½œæˆã™ã‚‹

```
wrangler r2 bucket list
```

ä¸‹è¨˜ã®ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¾ã™ã€‚

```
âœ˜ [ERROR] A request to the Cloudflare API (/accounts/*****/r2/buckets) failed.
Please enable R2 through the Cloudflare Dashboard. [code: 10042]
```

Cloudflareã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰R2ã‚’é–‹ãã€overviewã¸ç§»å‹•ã™ã‚‹ã¨Subscriptionç”»é¢ã«ãªã‚Šã¾ã™ã€‚

<FigImage alt="Subscriptionç”»é¢" src="https://storage.ephy.dev/blog-resources/article-cloudflare-r2/subscription/" />

ãƒ›ãƒ“ãƒ¼ãƒ¦ãƒ¼ã‚¹ã®ç¯„å›²ã§ã¯ç„¡æ–™ãªæ¨¡æ§˜ã€‚

- Class A operations
  - POSTãƒ»PUTç³»ã®ãƒã‚±ãƒƒãƒˆä½œæˆã‚„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ»ã‚³ãƒ”ãƒ¼
- Class B operations
  - GETç³»ã®ãƒã‚±ãƒƒãƒˆå–å¾—ã‚„ã‚µãƒãƒªå–å¾—
- Free operations
  - DELETEç³»ã®ãƒã‚±ãƒƒãƒˆãƒ»ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å‰Šé™¤ãªã©

ã¨ã„ã£ãŸé›°å›²æ°—ã§èªè­˜ã—ã¦ãŠã‘ã°å¤§ä¸ˆå¤«ãã†ã§ã™ã€‚

[Cloudflare R2 - Pricing](https://developers.cloudflare.com/r2/pricing/)

æ”¹ã‚ã¦ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```
wrangler r2 bucket list
[]
```

ä½•ã‚‚ä½œã£ã¦ã„ãªã„ã®ã§ç©ºã®é…åˆ—ãŒè¿”ã£ã¦ãã¾ã—ãŸã€‚ã¨ã‚Šã‚ãˆãšæ–°ã—ããƒã‚±ãƒƒãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚

[Cloudflare R2 - Create Buckets](https://developers.cloudflare.com/r2/buckets/create-buckets/)

```
wrangler r2 bucket create BUCKET_NAME
```

ãƒã‚±ãƒƒãƒˆåã¯ã€ã“ã®ã‚µã‚¤ãƒˆã§ã®åˆ©ç”¨ã‚’æƒ³å®šã—ã¦`ephy-dev`ã¨ã—ã¾ã—ãŸã€‚

```
wrangler r2 bucket list
[
  {
    "name": "ephy-dev",
    "creation_date": "2023-12-08T15:38:00.065Z"
  }
]
```

WebUIã®æ–¹ã‚’ç¢ºèªã—ã¦ã¿ã‚‹ã¨ãƒã‚±ãƒƒãƒˆãŒä½œæˆã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã™ã€‚ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ•ã‚©ãƒ«ãƒ€ã§ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚ãƒ•ã‚©ãƒ«ãƒ€ã«é–¢ã—ã¦ã¯ã€Finderãªã©ã‹ã‚‰ç›´æ¥ãƒ•ã‚¡ã‚¤ãƒ«è‡ªä½“ã‚’D&Dã™ã‚‹ã ã‘ã§ä¸­èº«ãŒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¾ã—ãŸã€‚

<FigImage
  alt="Cloudflare R2ã®WebUI"
  height={240}
  src="https://storage.ephy.dev/blog-resources/article-cloudflare-r2/bucket-list/"
/>

## ãƒ‰ãƒ¡ã‚¤ãƒ³ã®è¨­å®š

R2ã®ãƒã‚±ãƒƒãƒˆã«å¯¾ã—ã¦ç›´æ¥ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚‚è¨­å®šã§ãã‚‹ã¿ãŸã„ãªã®ã§ã€æ—©é€Ÿè¨­å®šã—ã¦ã¿ã¾ã—ãŸã€‚ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’è¨­å®šã™ã‚Œã°Cloudflareã®CacheãŒåŠ¹ããªã©ã®æ©æµãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚

è¨­å®šã¯ãƒã‚±ãƒƒãƒˆã®Settingsã‹ã‚‰è¡Œã„ã¾ã™ã€‚

<FigImage
  alt="ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³è¨­å®š"
  height={300}
  src="https://storage.ephy.dev/blog-resources/article-cloudflare-r2/custom-domain/"
/>

ãŠãã‚‰ãã§ã™ãŒã€ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ãªã—ã§å…¥åŠ›ã™ã‚‹ã¨ãã®ã¾ã¾ãƒ¡ã‚¤ãƒ³ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã¨R2ã®ãƒã‚±ãƒƒãƒˆãŒç´ã¥ã„ã¦ã—ã¾ã†ã‹ã‚‚ã—ã‚Œãªã„ã®ã§ã€ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã¯å…¥ã‚Œã¦ãŠãã¾ã—ã‚‡ã†ã€‚ä»Šå›ã¯`storage.ephy.dev`ã¨ã—ã¦ã„ã¾ã™ã€‚

Continueã‚’æŠ¼ä¸‹ã—ã¦é€²ã‚€ã¨è¨­å®šã¯å®Œäº†ã—ã¾ã™ã€‚Cloudflareã®ç®¡ç†ç”»é¢ã‹ã‚‰ãƒ‰ãƒ¡ã‚¤ãƒ³ã®Websiteã‚’é–‹ã„ã¦DNSè¨­å®šã‚’ç¢ºèªã—ã«è¡Œãã¨ã€è‡ªå‹•ã§è¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã—ãŸã€‚

<FigImage alt="DNSè¨­å®šç”»é¢" height={200} src="https://storage.ephy.dev/blog-resources/article-cloudflare-r2/dns/" />

R2ã®ãƒã‚±ãƒƒãƒˆã«æˆ»ã‚Šã€å…ˆç¨‹ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãŸç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã¨CustomDomainsã®é …ç›®ãŒå¢—ãˆã¦ã„ã¦ã€ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã«å‚ç…§ã§ãã‚‹ãƒªãƒ³ã‚¯ãŒæ·»ãˆã‚‰ã‚Œã¦ã„ã¾ã™ã€‚

<FigImage
  alt="ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯"
  height={260}
  src="https://storage.ephy.dev/blog-resources/article-cloudflare-r2/object-detail/"
/>

ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³ã«é–¢ã—ã¦ã¯ã€è¨­å®šã—ãŸã„R2ãƒã‚±ãƒƒãƒˆã¨ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ»Websiteã‚’ç®¡ç†ã—ã¦ã„ã‚‹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒåŒä¸€ã§ã‚ã‚‹å¿…è¦ãŒã‚ã£ãŸã‚Šã€HTTPSå¿…é ˆãªã©ã®åˆ¶ç´„ãŒã‚ã‚‹ã‚ˆã†ã§ã™ã€‚

[Cloudflare R2 - Custom Domain](https://developers.cloudflare.com/r2/buckets/public-buckets/#connect-a-bucket-to-a-custom-domain)

ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’è¨­å®šã—ãªã„å ´åˆã¯CloudflareãŒæä¾›ã™ã‚‹r2.devãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚ãŸã ã—ã€ã€Œãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆãªã©ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã®ã§é–‹ç™ºç”¨é€”ã«ä½¿ç”¨ã—ã¦ã­ã€‚ã€ã¨ã„ã£ãŸæ„Ÿã˜ã®ã“ã¨ãŒæ›¸ã‹ã‚Œã¦ã„ã¾ã™ã€‚

<FigImage
  alt="é–‹ç™ºç”¨ãƒ‰ãƒ¡ã‚¤ãƒ³è¨­å®š"
  height={240}
  src="https://storage.ephy.dev/blog-resources/article-cloudflare-r2/dev-domain/"
/>

## wranglerã‹ã‚‰ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæ“ä½œ

wranglerã‹ã‚‰ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªã‚³ãƒãƒ³ãƒ‰ã§ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ“ä½œã—ã¾ã™ã€‚

```
wrangler r2 object help

Commands:
  wrangler r2 object get <objectPath>     Fetch an object from an R2 bucket
  wrangler r2 object put <objectPath>     Create an object in an R2 bucket
  wrangler r2 object delete <objectPath>  Delete an object in an R2 bucket
```

### PUT

wranglerã®ã‚³ãƒãƒ³ãƒ‰ã¨ã€`ãƒã‚±ãƒƒãƒˆå`/`ä¿å­˜æ™‚ã®ãƒ‘ã‚¹(ä»»æ„)`/`ä¿å­˜æ™‚ã®ãƒ•ã‚¡ã‚¤ãƒ«å` --file=`ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰è‡ªä½“ãƒ•ã‚¡ã‚¤ãƒ«` ã¨ã„ã†æ„Ÿã˜ã§æŒ‡å®šã—ã¾ã™ã€‚

```
wrangler r2 object put ephy-dev/test-put.jpg --file=FaRANYUUcAA_c0t.jpg
```

### GET

wranglerã®ã‚³ãƒãƒ³ãƒ‰ã¨ã€`ãƒã‚±ãƒƒãƒˆå`/`ãƒ‘ã‚¹`/`ãƒ•ã‚¡ã‚¤ãƒ«å` ã§å–å¾—ã‚’ã—ã¾ã™ã€‚ä¿å­˜å…ˆã¯ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ãŸå ´æ‰€ã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚

```
wrangler r2 object get ephy-dev/test-put.jpg
```

### DELETE

wranglerã®ã‚³ãƒãƒ³ãƒ‰ã¨ã€`ãƒã‚±ãƒƒãƒˆå`/`ãƒ‘ã‚¹`/`ãƒ•ã‚¡ã‚¤ãƒ«å` ã§å‰Šé™¤ã§ãã¾ã™ã€‚

```
wrangler r2 object delete ephy-dev/test-put.jpg
```

## Cloudflare Workersã«ã‚ˆã‚‹R2ã®æ“ä½œ

[Cloudflare R2 - Workers API Usage](https://developers.cloudflare.com/r2/api/workers/workers-api-usage/)

Cloudflare Workersã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’åˆ©ç”¨ã—ã¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚npm createã‚³ãƒãƒ³ãƒ‰ã§ã‚¢ãƒ¬ã‚³ãƒ¬å¯¾è©±å¼ã§é¸æŠã—ã¦ã„ãã ã‘ã§åˆæœŸæ§‹ç¯‰ãŒçµ‚ã‚ã‚Šã¾ã™ã€‚

```
npm create cloudflare@latest
```

é€”ä¸­ã®ãƒ†ãƒ³ãƒ—ãƒ¬å†…å®¹é¸æŠã¯ä¸€æ—¦"Hello World" Workerã‚’é¸æŠ

```
â”œ What type of application do you want to create?
â”‚ type "Hello World" Worker
```

Workerã®æ–¹ã¯ãŠè©¦ã—ãªã®ã§ã€å…ˆã»ã©ä½œæˆã—ãŸãƒã‚±ãƒƒãƒˆã¨ã¯åˆ¥ã®ãƒã‚±ãƒƒãƒˆã«ã™ã‚‹ãŸã‚ã«åˆ¥é€”ä½œæˆã—ã¾ã™ã€‚

```
wrangler r2 bucket create ephy-worker-test
```

ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã«æ²¿ã£ã¦`wrangler.toml`ã‚’ä¿®æ­£ã—ã¾ã™ã€‚wranglerã®whoamiã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹ã¨è‡ªèº«ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆIDãŒã‚ã‹ã‚Šã¾ã™ã€‚è¦‹ãŸæ„Ÿã˜ã§ã™ãŒã€Cloudflareã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰URLã«å«ã¾ã‚Œã¦ã„ã‚‹ãƒãƒƒã‚·ãƒ¥å€¤ã¿ãŸã„ãªã‚„ã¤ãŒã‚¢ã‚«ã‚¦ãƒ³ãƒˆIDã§ã™ã€‚

```
wrangler whoami
```

ã‚¢ã‚«ã‚¦ãƒ³ãƒˆIDã®è¨­å®šã¨ä¸€ç·’ã«R2ã®ãƒã‚±ãƒƒãƒˆåã‚‚è¨­å®šã—ã¾ã™ã€‚`binding`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯JavaScriptä¸Šã§ç’°å¢ƒå¤‰æ•°ã¨ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã®å®šæ•°ã§ã™ã€‚

```toml
account_id = "YOUR_ACCOUNT_ID"
workers_dev = true

[[r2_buckets]]
binding = "MY_BUCKET"
bucket_name = "ephy-worker-test"
```

ã¨ã‚Šã‚ãˆãšãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã®é€šã‚Šã«`index.js`ã‚’ä¿®æ­£ã—ã¾ã™ã€‚å…ˆç¨‹ã®bindingã§è¨­å®šã—ãŸå®šæ•°ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã„ã‚‹ã‚³ãƒ¼ãƒ‰ãŒã‚ã‚‹ã®ã§ã€bindingã‚’`MY_BUCKET`ä»¥å¤–ã«è¨­å®šã—ãŸå ´åˆã¯ã€é©å®œä¿®æ­£ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

`hasValidHeader`ã§èªè¨¼ã‚­ãƒ¼ã®ãƒã‚§ãƒƒã‚¯ã‚’ã—ã€`ALLOW_LIST`ã«ã¯ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚

```js
const ALLOW_LIST = ["cat-pic.jpg"];
const hasValidHeader = (request, env) => {
  return request.headers.get("X-Custom-Auth-Key") === env.AUTH_KEY_SECRET;
};
function authorizeRequest(request, env, key) {
  switch (request.method) {
    case "PUT":
    case "DELETE":
      return hasValidHeader(request, env);
    case "GET":
      return ALLOW_LIST.includes(key);
    default:
      return false;
  }
}
export default {
  async fetch(request, env, ctx) {
    const url = new URL(request.url);
    const key = url.pathname.slice(1);

    if (!authorizeRequest(request, env, key)) {
      return new Response("Forbidden", { status: 403 });
    }

    switch (request.method) {
      case "PUT":
        await env.MY_BUCKET.put(key, request.body);
        return new Response(`Put ${key} successfully!`);
      case "GET":
        const object = await env.MY_BUCKET.get(key);

        if (object === null) {
          return new Response("Object Not Found", { status: 404 });
        }

        const headers = new Headers();
        object.writeHttpMetadata(headers);
        headers.set("etag", object.httpEtag);

        return new Response(object.body, {
          headers,
        });
      case "DELETE":
        await env.MY_BUCKET.delete(key);
        return new Response("Deleted!");

      default:
        return new Response("Method Not Allowed", {
          status: 405,
          headers: {
            Allow: "PUT, GET, DELETE",
          },
        });
    }
  },
};
```

å‹•ä½œã•ã›ã‚‹ãŸã‚ã«`AUTH_KEY_SECRET`ã‚’wranglerçµŒç”±ã§å–å¾—ã—ã¾ã™ã€‚

```
wrangler secret put AUTH_KEY_SECRET
 â›…ï¸ wrangler 3.19.0
-------------------
âœ” Enter a secret value: â€¦ ***********
ğŸŒ€ Creating the secret for the Worker "icy-shape-db66"
âœ¨ Success! Uploaded secret AUTH_KEY_SECRET
```

ä¸Šè¨˜ã®æ“ä½œã§è¡Œã£ãŸå†…å®¹ã¯ã€Workersã®ç®¡ç†ç”»é¢ã«ã‚ã‚‹Settingsã«è¨­å®šãŒè¿½åŠ ã•ã‚Œã¦ã„ã¾ã™ã€‚

<FigImage
  alt="ãƒã‚±ãƒƒãƒˆå¤‰æ•°"
  height={220}
  src="https://storage.ephy.dev/blog-resources/article-cloudflare-r2/bucket-variables/"
/>

å…ˆç¨‹ã®bindingsã¸ã‚‚tomlã®é€šã‚Šã«è¨­å®šã•ã‚Œã¦ã„ã¾ã™ã€‚

<FigImage
  alt="ãƒã‚±ãƒƒãƒˆå¤‰æ•°ãƒã‚¤ãƒ³ãƒ‰"
  height={220}
  src="https://storage.ephy.dev/blog-resources/article-cloudflare-r2/bucket-bindings/"
/>

ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã™ã€‚

```
wrangler deploy
```

ãƒ‡ãƒ—ãƒ­ã‚¤ãŒå®Œäº†ã—ãŸã‚‰è©¦ã—ã«curlã‚³ãƒãƒ³ãƒ‰ã§workersã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’å©ã„ã¦ã¿ã¾ã™ã€‚`your-worker.dev`ã¯è‡ªåˆ†ã®workerã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã«ç½®ãæ›ãˆã¾ã™ã€‚

```
curl https://your-worker.dev/cat-pic.jpg -X PUT --data-binary 'test'
```

ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã‚‚ã‚ã‚‹é€šã‚Šèªè¨¼ã‚­ãƒ¼ãŒãƒ˜ãƒƒãƒ€ã«å«ã¾ã‚Œã¦ã„ãªã„ã®ã§ã€ã“ã“ã§ã¯`Forbidden`ãŒè¿”ã£ã¦ãã¾ã™ã€‚`X-Custom-Auth-Key`ã‚’ãƒ˜ãƒƒãƒ€ã«è¿½åŠ ã—ã¦å†åº¦curlã‚’å©ã„ã¦ã¿ã¾ã™ã€‚

```
curl https://your-worker.dev/cat-pic.jpg -X PUT --header "X-Custom-Auth-Key: *********" --data-binary 'test'
```

```
Put cat-pic.jpg successfully!
```

`cat-pic.jpg`ã—ã‹è¨±å¯ã—ã¦ã„ãªã„ã®ã§ä»¥ä¸‹ã®curlã‚’è©¦ã™ã¨å‰è€…ã¯Forbiddenã«ãªã‚Šã€å¾Œè€…ã®ã¿æˆåŠŸã—ã¾ã™ã€‚

```
curl https://your-worker.dev/foo
curl https://your-worker.dev/cat-pic.jpg
```

ã¨ã„ã£ãŸæ„Ÿã˜ã§ã€R2ä¸Šã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¯¾ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ãªã©è‡ªå‰ã§ã‚„ã‚ŠãŸã„ã¨ã„ã†å ´åˆã¯Workersã‚’ä½¿ç”¨ã—ã¦å‡¦ç†ã™ã‚‹ã¨ã„ã†æ„Ÿã˜ã§ã—ãŸã€‚

[Cloudflare R2 - Workers API Reference](https://developers.cloudflare.com/r2/api/workers/workers-api-reference/)

## çµ‚ã‚ã‚Šã«

ã‚·ãƒ³ãƒ—ãƒ«ã§ä½¿ã„ã‚„ã™ã„ã¨æ€ã„ã¾ã—ãŸã€‚Cloudflareã«ãƒ‰ãƒ¡ã‚¤ãƒ³ç½®ã„ã¦ã„ãŸã‚Šã™ã‚‹å ´åˆã®æ‰‹è»½ã•ã‚‚ã™ã”ã„ã§ã™ã­ã€‚

ä»Šå›è©¦ã—ãŸã“ã¨ä»¥å¤–ã«ã€S3äº’æ›APIã®æä¾›ã‚‚ã‚ã‚Šãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚‚å……å®Ÿã—ã¦ã„ã‚‹ã‚ˆã†ãªã®ã§ã€æ©Ÿä¼šãŒã‚ã£ãŸã‚‰åˆ©ç”¨ã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚

[Cloudflare R2 - S3 API compatibility](https://developers.cloudflare.com/r2/api/s3/api/)

[Cloudflare R2 - Presined URL](https://developers.cloudflare.com/r2/api/s3/presigned-urls/#presigned-url-use-cases)
